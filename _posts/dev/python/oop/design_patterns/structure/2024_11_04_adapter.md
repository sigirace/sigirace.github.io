---
layout: single
title:  '[κµ¬μ΅°#2]Adapter Pattern'
toc: true
categories: Python
tags: [Adapter pattern, Python]

---



## π‘€ λ©μ 

> κΈ°μ΅΄ ν΄λμ¤μ μΈν„°νμ΄μ¤λ¥Ό ν΄λΌμ΄μ–ΈνΈκ°€ μ”κµ¬ν•λ” μΈν„°νμ΄μ¤λ΅ λ³€ν™ν•μ—¬, νΈν™λμ§€ μ•λ” μΈν„°νμ΄μ¤λ¥Ό κ°€μ§„ κ°μ²΄λ“¤μ΄ ν‘μ—…ν•  μ μλ„λ΅ ν•©λ‹λ‹¤.

- `κΈ°μ΅΄ ν΄λμ¤μ μΈν„°νμ΄μ¤`: μ΄λ―Έ μ΅΄μ¬ν•λ” μ‹μ¤ν…μ λ©”μ„λ“μ™€ μ†μ„±
- `ν΄λΌμ΄μ–ΈνΈκ°€ μ”κµ¬ν•λ” μΈν„°νμ΄μ¤`: ν΄λΌμ΄μ–ΈνΈκ°€ ν•„μ”λ΅ ν•λ” ν‘μ¤€ν™”λ κΈ°λ¥μ„ μ κ³µν•λ” μΈν„°νμ΄μ¤
- `νΈν™λμ§€ μ•μ€ μΈν„°νμ΄μ¤`: λ‘ μΈν„°νμ΄μ¤ κ°„μ λ¶μΌμΉ

## β™οΈ κµ¬μ„±μ”μ†

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/design_patterns/adapter.png?raw=true" width="500" height="300"></p>

- `Target`: ν΄λΌμ΄μ–ΈνΈκ°€ μ”κµ¬ν•λ” μΈν„°νμ΄μ¤(client interface)λ¥Ό μ •μ
- `Adaptee`: κΈ°μ΅΄μ— μλ” ν΄λμ¤, λ³€ν™μ΄ ν•„μ”ν• μΈν„°νμ΄μ¤λ¥Ό ν¬ν•¨
  - μƒλ΅μ΄ μ„λΉ„μ¤ λν• adapteeκ°€ λ  μ μμ

- `Adapter`: νƒ€κ² μΈν„°νμ΄μ¤μ™€ μ–΄λ‘ν‹° μΈν„°νμ΄μ¤ κ°„μ λ³€ν™ μν–‰

## π μμ‹

```
[ν„μ¬ μƒνƒ]
- AI μ±—λ΄‡μ€ Langchainμ„ ν†µν•΄ OpenAIμ ChatOpenAI λ¨λ“μ„ μ‚¬μ©ν•μ—¬ OpenAIμ™€ ν†µμ‹ ν•κ³  μμµλ‹λ‹¤.
- μ΄ κ²½μ° ν΄λΌμ΄μ–ΈνΈ(μ±—λ΄‡)λ” OpenAI API μ •μμ— λ§μ¶ λ°©μ‹μΌλ΅ μμ΅΄ν•κ³  μμµλ‹λ‹¤.

[λ³€κ²½ μ‚¬ν•­]
- Llama3.2 λ¨λΈμ΄ μ¶μ‹λμ–΄ μ¶”κ°€μ μΌλ΅ AI μ±—λ΄‡μ— ν†µν•©ν•κ³  μ‹¶μµλ‹λ‹¤.
- ν•μ§€λ§ Llama APIλ” OpenAI APIμ™€ μΈν„°νμ΄μ¤κ°€ λ‹¤λ¦…λ‹λ‹¤.
```

- `κΈ°μ΅΄ ν΄λμ¤μ μΈν„°νμ΄μ¤`: OpenAI APIκ°€ μ κ³µν•λ” λ©”μ„λ“μ™€ μ†μ„±μΌλ΅, AI μ±—λ΄‡μ΄ OpenAIμ™€ ν†µμ‹ ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ” μΈν„°νμ΄μ¤
- `ν΄λΌμ΄μ–ΈνΈκ°€ μ”κµ¬ν•λ” μΈν„°νμ΄μ¤`: Providerμ™€ μƒκ΄€ μ—†μ΄ μΌκ΄€λ λ°©μ‹μΌλ΅ LLMμ„ νΈμ¶ν•λ” μΈν„°νμ΄μ¤λ¥Ό μ”κµ¬
- `νΈν™λμ§€ μ•μ€ μΈν„°νμ΄μ¤`: κΈ°μ΅΄ OpenAI APIμ™€ μΌμΉν•μ§€ μ•λ” Llama μΈν„°νμ΄μ¤

## π“ κµ¬ν„

π“’ **ν”„λ΅μ νΈ κµ¬μ΅°**

```
β”β”€β”€ adapter.py
β”β”€β”€ app.py
β”β”€β”€ chat.py
β”β”€β”€ main.py
β””β”€β”€ services
    β”β”€β”€ llama.py
    β””β”€β”€ openai.py
```

π“’ **services/llama.py**

```python
class LlamaService:

    def __init__(self):
        pass

    def chatting(self, human_message:str) -> str:
        generation = f"YO I'm LLLLLLLAMA!!! your question is {human_message} right?\nthis is my answer! I don't knoW!!"

        return generation
```

π“’ **services/openai.py**

```python
class OpenAIService:

    def __init__(self):
        pass

    def chat_message(self, text:str) -> str:
        ai_response = f"Human message: {text}\nAI message: Ok man, I'm GPT~"
        return ai_response
```

π“’ **adapter.py**

```python
from chat import ChatInterface
from services.openai import OpenAIService
from services.llama import LlamaService

class OpenAIAdapter(ChatInterface):

    def __init__(self, open_ai: OpenAIService):
        self.open_ai = open_ai

    # override
    def invoke(self, query:str) -> str:
        response = self.open_ai.chat_message(query)
        return response
    

class LlamaAdapter(ChatInterface):

    def __init__(self, llama: LlamaService):
        self.llama = llama
    
    # override
    def invoke(self, query:str) -> str:
        response = self.llama.chatting(query)
        return response
```

π“’ **app.py**

```python
from chat import ChatInterface

class Client:

    def __init__(self, chat_module:ChatInterface):
        self.chat_module = chat_module
    
    def __call__(self, query:str) -> str:
        response = self.chat_module.invoke(query)
        return response
```

π“’ **chat.py**

```python
from abc import ABC, abstractmethod

class ChatInterface(ABC):

    @abstractmethod
    def invoke(self):
        pass
```

π“’ **main.py**

```python
from app import Client
from adapter import OpenAIAdapter, LlamaAdapter
from services.llama import LlamaService
from services.openai import OpenAIService


# μ–΄ν”λ¦¬μΌ€μ΄μ… μν–‰μ‹ μ „μ—­μΌλ΅ μ§€μ •/ Singleton instance
open_ai_service = OpenAIService()
open_ai_adapter = OpenAIAdapter(open_ai_service)
llama_servie = LlamaService()
llama_adapter = LlamaAdapter(llama_servie)


def main():

    choice = input("1. OpenAI Adapter\n2. Llama Adapter\nμ„ νƒν•μ„Έμ”: ")

    if choice == '1':
        adapter = open_ai_adapter  # OpenAI μ–΄λ‘ν„° μ„ νƒ
    elif choice == '2':
        adapter = llama_adapter  # Llama μ–΄λ‘ν„° μ„ νƒ
    else:
        print("μλ»λ μ„ νƒμ…λ‹λ‹¤.")
        return
    
    user_input = input("μ§λ¬Έμ„ μ…λ ¥ν•μ„Έμ”: ")
    
    chat_bot = Client(adapter)
    response = chat_bot(user_input)

    print("-"*30)
    print("[AI Response]")
    print(response)
    print("-"*30)

if __name__ == "__main__":
    main()
```

π–¥οΈ **μν–‰κ²°κ³Ό**

```python
1. OpenAI Adapter
2. Llama Adapter
μ„ νƒν•μ„Έμ”: 2
μ§λ¬Έμ„ μ…λ ¥ν•μ„Έμ”: ν•μ΄λ£¨~
------------------------------
[AI Response]
YO I'm LLLLLLLAMA!!! your question is ν•μ΄λ£¨~ right?
this is my answer! I don't knoW!!
------------------------------
```

## π’¬ μƒκ°ν•΄λ³Όκ²ƒ

**Q. adapter ν¨ν„΄μ€ μ„¤κ³„ λ‹¨κ³„μ—μ„ μ μ©ν•΄μ•Όν•λ”κ°€ μ μ§€λ³΄μ λ‹¨κ³„μ—μ„ μ μ©ν•΄μ•Ό ν•λ”κ°€?**

μ–΄λ‘ν„° ν¨ν„΄μ€ **μ„¤κ³„ λ‹¨κ³„μ—μ„ ν™•μ¥μ„±μ„ μ—Όλ‘μ— λ‘κ³  μ μ©ν•λ” κ²ƒμ΄ μ΄μƒμ **μ…λ‹λ‹¤. κ·Έλ¬λ‚, μ‹¤μ λ΅λ” μ‹μ¤ν…μ μ”κµ¬ μ‚¬ν•­μ΄λ‚ μƒν™©μ— λ”°λΌ κµ¬μ¶• μ΄ν›„μ— μ μ©ν•  μλ„ μμµλ‹λ‹¤. μ•„λμ—μ„ λ‘ κ°€μ§€ μ ‘κ·Ό λ°©μ‹μ— λ€ν•΄ μ„¤λ…ν•κ² μµλ‹λ‹¤.

### 1. μ„¤κ³„ λ‹¨κ³„μ—μ„μ μ μ©

- **ν™•μ¥μ„± κ³ λ ¤**: μ‹μ¤ν…μ„ μ²μ μ„¤κ³„ν•  λ• μ–΄λ‘ν„° ν¨ν„΄μ„ ν¬ν•¨μ‹ν‚¤λ©΄, ν–¥ν›„ μƒλ΅μ΄ μ‹μ¤ν…μ΄λ‚ APIλ¥Ό μ‰½κ² ν†µν•©ν•  μ μλ” κµ¬μ΅°λ¥Ό λ§λ ¨ν•  μ μμµλ‹λ‹¤. μ΄λ” μ μ§€λ³΄μμ„±κ³Ό μ μ—°μ„±μ„ ν–¥μƒμ‹ν‚µλ‹λ‹¤.
- **λ…ν™•ν• μΈν„°νμ΄μ¤ μ •μ**: κ° κµ¬μ„± μ”μ† κ°„μ μΈν„°νμ΄μ¤λ¥Ό λ…ν™•ν•κ² μ •μν•¨μΌλ΅μ¨, ν΄λΌμ΄μ–ΈνΈμ™€ λ‹¤λ¥Έ λ¨λ“ κ°„μ μƒνΈμ‘μ©μ„ λ…ν™•ν ν•κ³ , μ‹μ¤ν… μ „λ°μ μΌκ΄€μ„±μ„ λ†’μΌ μ μμµλ‹λ‹¤.
- **λ¨λ“ν™”**: μ–΄λ‘ν„° ν¨ν„΄μ„ μ‚¬μ©ν•λ©΄ κ° APIμ— λ€ν• ν†µν•© λ¨λ“μ„ λ…λ¦½μ μΌλ΅ κ΄€λ¦¬ν•  μ μμ–΄, νΉμ • APIμ λ³€κ²½μ΄ μ „μ²΄ μ‹μ¤ν…μ— λ―ΈμΉλ” μν–¥μ„ μµμ†ν™”ν•  μ μμµλ‹λ‹¤.

### 2. κµ¬μ¶• μ΄ν›„μ— μ μ©

- **ν•„μ”μ— μν• μ μ©**: κΈ°μ΅΄ μ‹μ¤ν…μ—μ„ μƒλ΅μ΄ APIλ‚ κΈ°λ¥μ„ μ¶”κ°€ν•  λ•, κΈ°μ΅΄ μ½”λ“κ°€ λ³µμ΅ν•κ±°λ‚ μƒνΈμ‘μ©μ΄ μ–΄λ ¤μ΄ κ²½μ° μ–΄λ‘ν„° ν¨ν„΄μ„ μ μ©ν•  μ μμµλ‹λ‹¤. μ΄ κ²½μ°, κΈ°μ΅΄ μ½”λ“μ— λ€ν• λ³€κ²½ μ—†μ΄ μƒλ΅μ΄ μΈν„°νμ΄μ¤λ¥Ό μ‰½κ² μ¶”κ°€ν•  μ μμµλ‹λ‹¤.
- **λ¦¬ν©ν† λ§**: μ΄κΈ° μ„¤κ³„μ—μ„ μ–΄λ‘ν„° ν¨ν„΄μ„ κ³ λ ¤ν•μ§€ μ•μ•λ‹¤λ©΄, μ‹μ¤ν…μ΄ ν™•μ¥λλ©΄μ„ λ°μƒν•λ” λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ μ–΄λ‘ν„° ν¨ν„΄μ„ μ μ©ν•  μ μμµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ κΈ°μ΅΄ μ½”λ“λ¥Ό λ¦¬ν©ν† λ§ν•μ—¬ μƒλ΅μ΄ μ”κµ¬ μ‚¬ν•­μ„ μ¶©μ΅±μ‹ν‚¬ μ μμµλ‹λ‹¤.
- **μ μ§„μ  κ°μ„ **: κΈ°μ΅΄ μ‹μ¤ν…μ—μ„ μƒλ΅μ΄ μ”κµ¬ μ‚¬ν•­μ΄ λ°μƒν–μ„ λ•, μ–΄λ‘ν„° ν¨ν„΄μ„ μ μ§„μ μΌλ΅ μ μ©ν•μ—¬ μ‹μ¤ν…μ„ κ°μ„ ν•  μ μμµλ‹λ‹¤.

### κ²°λ΅ 

μ–΄λ‘ν„° ν¨ν„΄μ€ μ„¤κ³„ λ‹¨κ³„μ—μ„ λ―Έλ¦¬ κ³ λ ¤ν•μ—¬ μ μ©ν•λ” κ²ƒμ΄ κ°€μ¥ μΆ‹μµλ‹λ‹¤. ν•μ§€λ§, ν•„μ”ν• κ²½μ° κΈ°μ΅΄ μ‹μ¤ν…μ—λ„ μ μ©ν•  μ μμµλ‹λ‹¤. μ‹μ¤ν…μ κµ¬μ΅°λ‚ μ”κµ¬ μ‚¬ν•­μ— λ”°λΌ μ μ—°ν•κ² ν™μ©ν•λ” κ²ƒμ΄ μ¤‘μ”ν•©λ‹λ‹¤. ν™•μ¥μ„±κ³Ό μ μ§€λ³΄μμ„±μ„ λ†’μ΄κΈ° μ„ν•΄ μ΄κΈ° μ„¤κ³„μ—μ„λ¶€ν„° μ–΄λ‘ν„° ν¨ν„΄μ„ μ—Όλ‘μ— λ‘λ” κ²ƒμ΄ λ°”λμ§ν•©λ‹λ‹¤.
