## 23.1 Installation



### 1. Installation

- firebase cli ì„¤ì¹˜

```dart
curl -sL https://firebase.tools | bash
```

- firebas login

```
firebase login
```

- flutterfire cli
  - firebaseì™€ ì†Œí†µí•˜ê¸° ìœ„í•´

```
dart pub global activate flutterfire_cli
```

- ëª…ë ¹ì–´ ì„¤ì • (warningì‹œ)

```
echo 'export PATH="$PATH:$HOME/.pub-cache/bin"' >> ~/.zshrc
source ~/.zshrc
```

- flutterfire configure
  - flutterì—ì„œ firebase ì„¤ì •

```
flutterfire configure
```

- step1. ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
  - firebase ì „ì²´ ì‹œìŠ¤í…œì—ì„œ ìœ ì¼í•´ì•¼í•¨
- step2. os ì„ íƒ
  - ìŠ¤í˜ì´ìŠ¤ë¡œ ì„ íƒ ì·¨ì†Œ
- step3. update yes!

ğŸ“Œ **Trouble Shooting**

```
sudo gem install xcodeproj
or
gem install xcodeproj --user-install
```

- firebase plugin
  - pluginì„ ì¶”ê°€ ì œê±°í•  ë•Œë§ˆë‹¤ ì‹¤í–‰í•´ì•¼í•¨

```
flutter pub add firebase_core
flutter pub add firebase_auth
flutter pub add cloud_firestore
flutter pub add firebase_storage

flutterfire configure
```



### 2.  Initialization

```dart
void main() async{
  ...
  await Firebase.initializeApp(options: DefaultFirebaseOptions.currentPlatform);
  ...
}
```



ğŸ“Œ **Trouble Shooting**

- ios ë²„ì „ ì—ëŸ¬ê°€ ë‚œë‹¤ë©´ ios/Podfile ìˆ˜ì •

```
# ê¸°ì¡´:
# platform :ios, '9.0'
# platform :ios, '11.0'

# ìˆ˜ì • í›„:
platform :ios, '13.0' # ì—ëŸ¬ì—ì„œ ë‚˜íƒ€ë‚œ ë²„ì „
```



## 23.2 AuthenticationRepository

### 1. redirect

- ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ì§€ ì•Šì•˜ì„ ë•Œ Sign up í˜ì´ì§€ë¡œ redirect routing
- GoRouterë¥¼ provider ì•ˆì— ë°°ì¹˜
  - subloc: sub locationìœ¼ë¡œ userê°€ ìˆëŠ” ê³³ì„ ê°€ë¥´í‚´
  - ë‹¨, redirectë¡œ ë°˜í™˜í•˜ëŠ” widgetì´ routesì— ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•¨

```dart
final routerProvider = Provider((ref) {
  return GoRouter(
    redirect: (context, state) {
      final isLoggedIn = ref.read(authRepo).isLoggedIn;
      if (state.subloc != SignupScreen.routeURL && !isLoggedIn) {
        return SignupScreen.routeURL;
      }
      return null;
    },
  	initialLocation: "",
    routes: [
      ...
    ]
  )
})
```

- mainì˜ classë¥¼ cunsumerWidgetìœ¼ë¡œ ë³€ê²½

```dart
return MaterialApp.router(
	routerConfig: ref.watch(routerProvider),
)
```

- firebaseì™€ ì—°ë™í•˜ëŠ” repository ìƒì„±

```dart
class AuthenticationRepository {
  final FirebaseAuth _firebasAuth = FirebaseAuth.instance;

  bool get isLoggedIn => _firebasAuth.currentUser != null;
  User? get user => _firebasAuth.currentUser;
}

final authRepo = Provider((ref) => AuthenticationRepository().user);
```

- firebaseëŠ” initializeí•˜ëŠ” ì‹œì ì— ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ë©´ ì†Œí†µê°€ëŠ¥

