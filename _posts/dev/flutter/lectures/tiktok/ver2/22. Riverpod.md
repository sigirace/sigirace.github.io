## 22.0 Introduction

### 1. installation

- flutter_riverpod: ^2.1.3



## 22.1 NotifierProvider

### 1. refactoring

- runAppì˜ childë¥¼ ProviderScopeë¡œ ê°ìŒˆ
- context.read/watch ëª¨ë‘ ì‚­ì œ



### 2. Notifier

- NotifyListenersë¥¼ ê°€ì§€ì§€ ì•ŠìŒ
- Notifier.buildëŠ” ìœ„ì ¯ì´ ê°–ê³  ìˆëŠ” build ë©”ì„œë“œ ê°™ì€ ê±°ë¼ê³  ìƒê°í•  ìˆ˜ ìˆìŒ
  - buildë¥¼ í†µí•´ ë¦¬í„´ë˜ëŠ” ê²ƒì€ ì‚¬ìš©ìê°€ ë³´ê²Œ ë , í™”ë©´ì´ ê°–ê²Œ ë  ì´ˆê¸°ì˜ ë°ì´í„°
  - ì´ ìì²´ë¡œ stateë¥¼ ê°–ê²Œ ë¨
- Notifierì—ê²Œ ëª¨ë¸ì„ ë…¸ì¶œì‹œí‚¤ë¼ê³  ì „ë‹¬í•¨
  - ëª¨ë¸ì´ ê°€ì§€ê³  ìˆëŠ” ë°ì´í„°ê°€ listení•˜ê³  watchí•˜ê¸°ë¥¼ ì›í•˜ëŠ” ê²ƒ
- stateë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì€ reactì™€ ë™ì¼í•˜ê²Œ ë®ì–´ ì“°ëŠ”ê²ƒì´ ì•„ë‹Œ ìƒˆë¡œ ìƒì„±í•˜ëŠ” ê²ƒ
  - í™”ë©´ì´ ìƒˆë¡œ ë¹Œë“œë¨
- viewmodelì„ ë…¸ì¶œì‹œí‚¬ providerë¥¼ ìƒì„±í•´ì•¼í•¨
  - ìƒì†ë°›ì€ notifier ì¢…ë¥˜ì™€ ë™ì¼í•œ íƒ€ì…
  - ì²«ë²ˆì§¸ ì¸ìëŠ” ë…¸ì¶œì‹œí‚¬ vm
  - ë‘ë²ˆì§¸ ì¸ìëŠ” providerê°€ ë…¸ì¶œì‹œí‚¬ ë°ì´í„° ëª¨ë¸

ğŸ“’ **Example**

```dart
class PlaybackConfigViewModel extends Notifier<PlaybackConfigModel>{
  
  final PlaybackConfigRepository _repository;
  
  PlaybackConfigViewModel(this._repository);
  
  void setMuted(bool value){
    _repository.setMuted(value);
    state = PlaybackConfigModel(
      muted: value, 
      autoplay: state.autoplay,
    );
  }
  
  void setAutoplay(bool value){
    _repository.setAutoplay(value);
    state = PlaybackConfigModel(
      muted: state.muted,
      autoplay: value,
    );
  }
 
  @override
  PlaybackConfigModel build(){
    return PlaybackConfigModel(
    	muted: _repository.isMuted(),
      autoplay: _repository.isAutoplay(),
    )
  }
}

final playbackConfigProvider = NotifierProvider<
  PlaybackConfigViewModel, 
	PlaybackConfigModel
  >(
    ()=> throw UnimplementedError();
  )
```



ğŸ“ **UnimplementedError**

- PlaybackConfigViewModelë¥¼ ì´ˆê¸°í™”í•˜ê¸° ìœ„í•´ì„œëŠ” repositoryë¥¼ ì¸ìë¡œ ë°›ì•„ì•¼í•¨
- repositoryëŠ” SharedPreferencesë¥¼ í†µí•´ ì•±ì´ ì²˜ìŒ ë¹Œë“œì‹œ ìƒì„±ë¨
  - ë”°ë¼ì„œ ì´ˆê¸°í™”í•˜ë ¤ë©´ ì•±ì´ ë¹Œë“œë ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼í•¨ (await ë•Œë¬¸)
  - ì•±ì´ ë¹Œë“œëœ í›„ ìˆ˜í–‰ë  ìˆ˜ ìˆë„ë¡ overrideí•¨




### 3. Override

```dart
void main() async {
  ...
    
  runApp(
	  ProviderScope(
      overrides: [
        playbackConfigProvider.overrideWidth(()=>PlaybackConfigViewModel(repository)),
      ]
      child: TikTokApp()
    ),
  );
}
```



## 22.2 ConsumerWidget

### 1. ConsumerWidget

- riverpodì—ì„œ ì˜¤ëŠ” ê²ƒ
- buildì‹œì— WidgetRefë¥¼ ë°›ìŒ
  - refë¥¼ í†µí•´ ë°ì´í„°ì— ì ‘ê·¼í•¨
- read, watchëŠ” ë°ì´í„°ì—ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŒ
- classmethodì— ì ‘ê·¼í•˜ë ¤ë©´ notifierë¥¼ ì‚¬ìš©í•¨

ğŸ“’ **Example**

```dart
SwitchListTile.adaptive(
	value: ref.watch(playbackConfigProvider).muted,
  onChange: (value) => 
    ref.read(playbackConfigProvider.notifier).setMuted(value),
)
```

### 2. extention

- flutter riverpod snippets
- ì—¬ëŸ¬ shortcutë“¤ì„ ì œê³µí•¨



## 22.4 AsyncNotifierProvider

### 1. FutureOr

- async ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ FutureOrë¡œ build ìˆ˜í–‰
- awaitë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ë°›ì•„ì˜´



### 2. when

- widgetì˜ buildì‹œ ë¦¬í„´í•˜ëŠ” í™”ë©´ì— ëŒ€í•´ ì»¨íŠ¸ë¡¤ ê°€ëŠ¥
- loading, error, data

ğŸ“’ **Example**

```dart
@override
Widget build(BuildContext context){
  return ref.watch(somethingProvider).when(
  	laoding: () => const Center(
    	child: CircularProgressIndicator(),
    ),
    error: (error: stackTrace) => Center(
    	child: Text('Could not load videos: $error'),
    ),
    data: (datas) => Widget(
    	...
    )
  )
}
```



### 3. async data control

- stateë¥¼ ì—…ë°ì´íŠ¸ ì‹œí‚¤ê¸° ìœ„í•´ì„œ AsyncValue.dataë¥¼ ì‚¬ìš©
  - AsyncNotifierì•ˆì—ëŠ” loading, error, dataì™€ ê°™ì€ async ê°’ë“¤ì´ ìˆê¸° ë•Œë¬¸
- loading ìƒíƒœë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ì„  AsyncValue.loading ì‚¬ìš©
  - ì´ë¯¸ fetching ëœ ìƒíƒœì—ì„œ ë°ì´í„°ê°€ ì¶”ê°€ë˜ì—ˆì„ë•Œ loadingìƒíƒœë¡œ ë³€ê²½í•¨

