## 4. ORM

### 4.1 QuerySet

- lazy: ì„ ì–¸ë˜ëŠ” ì¦‰ì‹œ ì „ì²´ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ì•ŠìŒ
  - ìˆ˜í–‰ ì‹œì ì— ê°€ì„œì•¼ DBì™€ í†µì‹ í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´

- Admin Method(all, get, filter ë“±)ë¥¼ ì‚¬ìš©í•´ì•¼ ì‹¤ì œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´

### 4.2 function

- model í˜¹ì€ adminì— functionì„ ì‚¬ìš©í•´ì„œ ì¶”ê°€ì ìœ¼ë¡œ ë³´ê³ ì‹¶ì€ ë°ì´í„°ë¥¼ ì •ì˜í•  ìˆ˜ ìˆìŒ

### 4.3 ForeignKey Filter

- FKë“¤ì€ ì—­ìœ¼ë¡œ ìì‹ ì„ ê°€ë¥´í‚¤ëŠ”ê²Œ ë­”ì§€ ì•Œê³ ì‹¶ë‹¤
- Roomì€ userë¥¼ foreignKeyë¡œ ê°€ì§€ê³  ìˆìŒ
  - Roomì´ Userë¥¼ ê°€ë¥´í‚¤ëŠ” ê²ƒ
- ê´€ì ì€ user ì…ì¥ì—ì„œ ëˆ„ê°€ ë‚˜ë¥¼ ê°€ë¥´í‚¤ëŠ”ì§€ ì•Œê³  ì‹¶ì€ ê²ƒ
- Querysetì˜ ì—°ì‚°ìë¡œ fkë¥¼ ì“°ëŠ” ë°©ë²•ìœ¼ë¡œ ìˆ˜í–‰

```python
Room.objects.filter(owner__username="sigi")
```

- í•„í„°ë§ì„ í•˜ëŠ” ê²ƒì€ ë°˜ë³µì´ ë§ì´ ë“¤ì–´ê°€ì„œ ê·€ì°®ì•„
- ë” ì‰¬ìš´ë°©ë²•ì´ reverse accessors

### 4.3 Reverse accessors

- ëª¨ë¸ Aê°€ ëª¨ë¸ Bì— foreign keyë¥¼ ê°€ì§€ê³  ìˆì„ ë•Œ, ëª¨ë¸BëŠ” ìë™ì ìœ¼ë¡œ ëª¨ë¸ A_setì„ ë°›ê²Œ ë¨
- A_setì„ í†µí•´ ì—­ì ‘ê·¼ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ
- ì¦‰, ë‚˜ë¥¼ ê°€ë¥´í‚¤ëŠ” ê²ƒë“¤ì„ ì°¾ì•„ë‚¼ ìˆ˜ ìˆìŒ

### 4.3 related_name

> ëª¨ë¸ ì´ë¦„ì„ related_nameìœ¼ë¡œ ì„¤ì •í•¨

- related_nameì„ ì§€ì •í•˜ë©´ ë”ì´ìƒ setì„ ê°€ì§€ì§€ ì•Šì•„ë„ ë¨
- migrate í•„ìš”

### ğŸŒˆ Example

**1. Relation**

- Model A(User) <- ForeignKey -> Model B(Room)

**2. model**

```python
## Room
class Room():
  ...
  owner = models.ForeignKey(
    "users.User",
    on_delete=models.CASCADE,
    related_name="rooms", # ëª¨ë¸ ì´ë¦„ì„ ë“±ë¡
  )
```

**3. python**

```python
# Using in python
from users.models import User
me = User.objects.get(pk=1)
me.rooms.all() # ë‹¤ë¥¸ ëª¨ë¸ì—ì„œ ì‚¬ìš© / meë¥¼ ê°€ë¥´í‚¤ëŠ” roomì„ ê°€ì ¸ì™€ë¼
```



ğŸ’¡ **object.fields vs obejct.fields.all()**

- object.fileds.all(): ëª¨ë“  ë¦¬ë·°ë¥¼ ì¿¼ë¦¬ì…‹ìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ëª…ì‹œì ì´ê³  ê¶Œì¥ë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
- object.fileds: ë‚´ë¶€ì ìœ¼ë¡œ all()ì´ í˜¸ì¶œë˜ì–´ ë™ì¼í•˜ê²Œ ë™ì‘í•˜ì§€ë§Œ, object.fileds.all()ì´ ë” ëª…í™•í•˜ê³  ê°€ë…ì„±ì´ ì¢‹ìŠµë‹ˆë‹¤.
