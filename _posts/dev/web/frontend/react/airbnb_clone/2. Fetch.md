### 19.0 Manual Fetching

ğŸ“**CORS**

- ì„œë²„ê°€ ì‚¬ìš©ìë“¤ì—ê²Œ ì„œë²„ë¡œë¶€í„° ë¬´ì–¸ê°€ë¥¼ fetch í•˜ëŠ” ê²ƒì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒ
- ì„œë²„ê°€ fetch í•˜ë ¤ëŠ” ì‚¬ëŒë“¤ì„ ì„œë²„ë¡œë¶€í„° ì°¨ë‹¨í•˜ê³  ìˆìŒ
- ğŸ“œ [cors ë¬¸ì„œ](https://github.com/adamchainz/django-cors-headers)

Step1. django-cors-headers ì„¤ì¹˜

```
poetry add django-cors-headers
```

Step2. Setting

```python
THIRD_PARTY_APPS =[
	...,
  "corsheaders",
  ...
]

MIDDLEWARE = [
  ...,
  "corsheaders.middleware.CorsMiddleware",
  ...
]

CORS_ALLOWED_ORIGINS = ["http://localhost:3000"]
```

- CORS_ALLOWED_ORIGINS: http ìš”ì²­ì„ í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ìˆëŠ” ëª©ë¡
- DNS êµ¬ë§¤ì‹œ ë“±ë¡ëœ ì›¹ì„œë²„ì˜ ë„ë©”ì¸ì„ ë„£ì–´ì¤˜ì•¼í•¨
  - ê²°êµ­ ì›¹ì„œë²„ê°€ ìš”ì²­í•  ê²ƒì´ê¸° ë•Œë¬¸

### 19.2 React Query

ğŸ“œ [Tanstack](https://tanstack.com/)

Step1. Install

```
npm i @tanstack/react-query @tanstack/react-query-devtools
```

Step2. index ìˆ˜ì •

```typescript
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";

const client = new QueryClient();

...
<QueryClientProvider client={client}>
  ...
</QueryClientProvider>
...
```

- ì½”ë“œë¥¼ ì¤„ì—¬ì£¼ëŠ” ê±° ì™¸ì—ë„ React QueryëŠ” ìºì‹±ì„ í•´ ì¤„ ê²ƒì„

Step3. api íŒŒì¼ ìƒì„±

- api.ts

```typescript
const BASE_URL = "http://127.0.0.1:8000/api/v1";

export async function getRooms() {
  const response = await fetch(`${BASE_URL}/rooms/`);
  const json = await response.json();
  return json;
}
```

Step4. useQuery ì‚¬ìš©

```typescript
import { useQuery } from "@tanstack/react-query"

export default function Home() {
  ...
  
	const { isLoading, data } = useQuery<IRoom[]>({
    queryKey: ["rooms"],
    queryFn: getRooms,
  });
  
  ...
```

- key
  - fetchí•œ ê²°ê³¼ë¬¼ì„ ê¸°ì–µí•¨ â˜ ìºì‹± ì‘ì—…ì— ì´ìš©ë¨
  - arrayê°€ ë˜ì–´ì•¼í•¨
- function
  - ì‹¤ì œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜

### 19.3 Axios

- api.ts ìˆ˜ì •

```typescript
import axios from "axios";

const instance = axios.create({
  baseURL: "http://127.0.0.1:8000/api/v1",
});

export const getRooms = () => instance.get("rooms/").then((response)=> response.data);
```

- ë‚´ë¶€ì ìœ¼ë¡œ await ë“± ì—¬ëŸ¬ ì‘ì—…ì„ ë„ì™€ì¤Œ
- ë³´ê¸°ì—ëŠ” ë¹ˆ í•¨ìˆ˜ì´ì§€ë§Œ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ì˜¤ê³  ìˆìŒ

```
meta:
pageParam:
queryKey: Array
...
```

- 

### 19.4 

- install

```
npm i @tanstack/react-query-devtools
```

