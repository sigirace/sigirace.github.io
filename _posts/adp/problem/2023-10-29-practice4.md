---
layout: single
title:  'ADP ì‹¤ê¸° ì—°ìŠµë¬¸ì œ (4)'
toc: true
categories: [ADP]
tags: [Missing Value, Clustering,  KMEANS, DBSCAN, PCA, Chi-square, Moving Average]

---

ë³¸ ê²Œì‹œë¬¼ì€ ADP ì‹¤ê¸°ì˜ ì—°ìŠµë¬¸ì œ í’€ì´ì— ëŒ€í•œ ê²ƒì´ë‹¤.
{: .notice}

# ë¨¸ì‹ ëŸ¬ë‹

## 1. ë°ì´í„° ì „ì²˜ë¦¬ ë° êµ°ì§‘ ìƒì„±

### 1.1 ê²°ì¸¡ì¹˜ë¥¼ í™•ì¸í•˜ê³  ì œê±°

````python
import warnings
warnings.filterwarnings('ignore')
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

data = pd.read_csv("https://raw.githubusercontent.com/ADPclass/ADP_book_ver01/main/data/26_problem1.csv")
data
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/1.png?raw=true" width="900" height="350"></p>

````python
data_desc = data.describe()
data_desc
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/2.png?raw=true" width="900" height="200"></p>

````python
pd.DataFrame(data_desc.loc['std',:]).sort_values(by=['std'], ascending=False)
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/3.png?raw=true" width="300" height="350"></p>

````
data.info()
````

````
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   ID                   2240 non-null   int64  
 1   Year_Birth           2240 non-null   int64  
 2   Marital_Status       2240 non-null   object 
 3   Income               2216 non-null   float64
 4   Kidhome              2240 non-null   int64  
 5   Teenhome             2240 non-null   int64  
 6   MntWines             2240 non-null   int64  
 7   MntFruits            2240 non-null   int64  
 8   MntMeatProducts      2240 non-null   int64  
 9   MntFishProducts      2240 non-null   int64  
 10  MntSweetProducts     2240 non-null   int64  
 11  NumDealsPurchases    2240 non-null   int64  
 12  NumWebPurchases      2240 non-null   int64  
 13  NumCatalogPurchases  2240 non-null   int64  
 14  NumStorePurchases    2240 non-null   int64  
 15  NumWebVisitsMonth    2240 non-null   int64  
dtypes: float64(1), int64(14), object(1)
````

ğŸ“ **ë°ì´í„° íƒìƒ‰ ê²°ê³¼**

1. missing value: Incomeì— ê²°ì¸¡ì¹˜ ì¡´ì¬
2. outlier: í¸ì°¨ê°€ í° Incomeì— ëŒ€í•´ ì´ìƒì¹˜ íƒìƒ‰ í•„ìš”
3. scaling: ê° ì»¬ëŸ¼ì˜ max ê°’ì´ ìƒì´í•˜ê¸° ë•Œë¬¸ì— ì°¨ì´ê°€ í´ ê²½ìš° ìŠ¤ì¼€ì¼ë§ ê³ ë ¤
4. feature type: Kidhome, Teenhome, Marital_Statusì€ categorical feature ë‚˜ë¨¸ì§€ëŠ” numerical feature

ğŸ‘€ **ê²°ì¸¡ì¹˜ íƒìƒ‰**

````python
df_isna = pd.DataFrame(data.isna().sum(), columns=['null_cnt'])
df_isna
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/4.png?raw=true" width="300" height="350"></p>

ğŸ‘€ **ê²°ì¸¡ì¹˜ ë¹„ìœ¨ í™•ì¸**

````python
for null_col in df_isna[df_isna.null_cnt > 0].index.to_list():
    print("*"*15)
    print("ê²°ì¸¡ì¹˜ ì»¬ëŸ¼ :", null_col)
    print("ê²°ì¸¡ì¹˜ ë¹„ìœ¨ : {}%".format(df_isna.loc[null_col].null_cnt *100/ len(data)))
    print("describe")
    print(data[null_col].describe())
````

````
***************
ê²°ì¸¡ì¹˜ ì»¬ëŸ¼ : Income
ê²°ì¸¡ì¹˜ ë¹„ìœ¨ : 1.0714285714285714%
describe
count      2216.000000
mean      52247.251354
std       25173.076661
min        1730.000000
25%       35303.000000
50%       51381.500000
75%       68522.000000
max      666666.000000
````

â˜€ï¸ **ê²°ì¸¡ì¹˜ ì²˜ë¦¬**

- ì•½ 1%ì˜ ë°ì´í„°ê°€ ê²°ì¸¡ì¹˜ë¡œ í™•ì¸ë¨
- ì´ìƒì¹˜ê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ëª¨ë¸ë§ì„ í†µí•œ ì œê±° ë³´ë‹¤ëŠ” mean, median ë“±ì„ í†µí•œ ëŒ€ì²´

````python
income_mean = data['Income'].median()
data['Income'].fillna(income_mean, inplace=True)
data.isna().sum()
````

````
ID                     0
Year_Birth             0
Marital_Status         0
Income                 0
Kidhome                0
Teenhome               0
MntWines               0
MntFruits              0
MntMeatProducts        0
MntFishProducts        0
MntSweetProducts       0
NumDealsPurchases      0
NumWebPurchases        0
NumCatalogPurchases    0
NumStorePurchases      0
NumWebVisitsMonth      0
````

### 1.2 ì´ìƒì¹˜ ì œê±°

ğŸ‘€ **ë°ì´í„° ì‹œê°í™”**

````python
# ìˆ˜ì¹˜í˜•
numerical_columns = ['Year_Birth', 'Income',
       'MntWines', 'MntFruits', 'MntMeatProducts', 'MntFishProducts',
       'MntSweetProducts', 'NumDealsPurchases', 'NumWebPurchases',
       'NumCatalogPurchases', 'NumStorePurchases', 'NumWebVisitsMonth']
# ë²”ì£¼í˜•
categorical_columns = ['Kidhome', 'Teenhome','Marital_Status']
````

ğŸ‘€ **ìˆ˜ì¹˜í˜•-íˆìŠ¤í† ê·¸ë¨**

````python
fig, axes = plt.subplots(nrows=3, ncols=4, figsize=(15, 10))

for i, column in enumerate(numerical_columns):

    row = i // 4
    col = i % 4
    data[column].plot(kind='hist', bins=20, ax=axes[row, col], color='skyblue', edgecolor='black')
    axes[row, col].set_title(f'Histogram of {column}')
    axes[row, col].set_xlabel(column)
    axes[row, col].set_ylabel('Frequency')

plt.tight_layout()

plt.show()
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/5.png?raw=true" width="900" height="500"></p>

ğŸ‘€ **ìˆ˜ì¹˜í˜•-ë°•ìŠ¤í”Œë¡¯**

````python
fig, axes = plt.subplots(nrows=3, ncols=4, figsize=(15, 8))

for i, column in enumerate(numerical_columns):

    row = i // 4
    col = i % 4
    sns.boxplot(x=data[column], ax=axes[row, col], color='skyblue')
    axes[row, col].set_title(f'Box plot of {column}')
    axes[row, col].set_xlabel(column)
    axes[row, col].set_ylabel('Frequency')

plt.tight_layout()
plt.show()
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/6.png?raw=true" width="900" height="400"></p>

ğŸ‘€ **ë²”ì£¼í˜•-ë§‰ëŒ€ê·¸ë˜í”„**

````python
fig, axes = plt.subplots(nrows=1, ncols=3, figsize=(15, 4))

for i, column in enumerate(categorical_columns):

    data[column].value_counts().sort_index().plot(kind='bar', ax=axes[i], color='skyblue')
    axes[i].set_title(f'Bar Plot of {column}')
    axes[i].set_xlabel(column)
    axes[i].set_ylabel('Frequency')

plt.tight_layout()
plt.show()
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/7.png?raw=true" width="900" height="250"></p>

ğŸ“ **ì´ìƒì¹˜ íƒìƒ‰ì„ ìœ„í•œ ì‹œê°í™” ê²°ê³¼**

- Year_BirthëŠ” 1900 ì´ì „ì€ ì´ìƒì¹˜ë¡œ íŒë‹¨
- Incomeì€ í‰ê· ë³´ë‹¤ ë§ì´ ë–¨ì–´ì§„ ì§€ì ì´ ìˆìœ¼ë¯€ë¡œ IQRì„ í†µí•´ ì œê±°
- ë‚˜ë¨¸ì§€ ì»¬ëŸ¼ë“¤ì€ ì´ìƒì¹˜ê°€ ì—°ì†ì ì´ë¯€ë¡œ ì œê±°ë¥¼ ìœ„í•´ì„œëŠ” í˜„ì—…ì˜ ì˜ê²¬ì´ í•„ìš”

````python
data = data[data.Year_Birth > 1900].reset_index(drop=True)
````

â˜€ï¸ **IQRì„ í†µí•œ ì´ìƒì¹˜ ì œê±°**

````python
def detect_outliers(df=None, column=None, weight=1.5):
    Q1 = df[column].quantile(0.25)
    Q3 = df[column].quantile(0.75)
    IQR = Q3 - Q1
    IQR_weight = IQR*weight
    outlier_idx = df[(df[column] < Q1 - IQR_weight) | (df[column] > Q3 + IQR_weight)].index
    return outlier_idx
  
outlier_idx = detect_outliers(df=data, column='Income')
data.iloc[outlier_idx]
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/7.png?raw=true" width="900" height="300"></p>

- 666666ì„ ì œì™¸í•˜ê³ ëŠ” ë¹„ìŠ·í•œ ê°’ì„ ê°€ì§€ë¯€ë¡œ ê³ ì†Œë“ì¸µì´ë¼ ìƒê°í•´ë„ ë¬´ë°©

````python
data = data[data.Income < 666666]
````

### 1.3 Kmeans, DBSCANì˜ ë°©ì‹ìœ¼ë¡œ êµ°ì§‘í™” ìˆ˜í–‰

â˜€ï¸ **êµ°ì§‘í™”ë¥¼ ìœ„í•œ ë²”ì£¼í˜• ë³€ìˆ˜ì²˜ë¦¬**

- categorical columns ì¤‘ Marital_StatusëŠ” ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬ê°€ í•„ìš”
- ìˆœì„œê°€ ì—†ëŠ” ì»¬ëŸ¼ì´ê¸°ì— one-hot encoding ìˆ˜í–‰

````python
df_encoded = pd.get_dummies(data, columns=['Marital_Status'], prefix=['Category'])
df_encoded
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/8.png?raw=true" width="900" height="200"></p>

â˜€ï¸ **Kmeans**

- ìµœì ì˜ êµ°ì§‘ì„ ì°¾ê¸° ìœ„í•œ elbow ê¸°ë²•

````python
from sklearn.cluster import KMeans

def elbow(X):
    sse = []
    for i in range(1, 11):
        km = KMeans(n_clusters=i, random_state=1)
        km.fit(X)
        sse.append(km.inertia_)

    # SSEë¥¼ ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•˜ì—¬ ìµœì  í´ëŸ¬ìŠ¤í„° ìˆ˜ ê²°ì •
    plt.plot(range(1, 11), sse, marker='o')
    plt.xlabel('The Number of Clusters')
    plt.ylabel('SSE')
    plt.title('Elbow Method for Optimal k')
    plt.show()

X = np.array(df_encoded[['Year_Birth', 'Income', 'Kidhome', 'Teenhome', 'MntWines',
       'MntFruits', 'MntMeatProducts', 'MntFishProducts', 'MntSweetProducts',
       'NumDealsPurchases', 'NumWebPurchases', 'NumCatalogPurchases',
       'NumStorePurchases', 'NumWebVisitsMonth', 'Category_Absurd',
       'Category_Alone', 'Category_Divorced', 'Category_Married',
       'Category_Single', 'Category_Together', 'Category_Widow',
       'Category_YOLO']])

elbow(X)
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/10.png?raw=true" width="700" height="350"></p>

````python
km = KMeans(n_clusters =3, random_state=1)
km.fit(X)
data['label_kmeans'] = km.labels_
````

â˜€ï¸ **DBSCAN**

````python
from sklearn.cluster import DBSCAN
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
scaled_data = scaler.fit_transform(X)

dbscan = DBSCAN(eps=5, min_samples=2)  # epsì™€ min_samplesëŠ” ì¡°ì • ê°€ëŠ¥
dbscan.fit(scaled_data)

cluster_labels = dbscan.labels_

data['label_dbscan'] = cluster_labels
data.label_dbscan.value_counts()
````

````
 0    2136
 2      77
 5       4
-1       3
 3       3
 6       3
 1       2
 4       2
 7       2
 8       2
 9       2
````

ğŸ‘€ **êµ°ì§‘í™” ì‹œê°í™”-ë¹ˆë„ìˆ˜**

````python
fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(15, 4))

for i, column in enumerate(['label_kmeans', 'label_dbscan']):

    data[column].value_counts().sort_index().plot(kind='bar', ax=axes[i], color='skyblue')
    axes[i].set_title(f'Bar Plot of {column}')
    axes[i].set_xlabel(column)
    axes[i].set_ylabel('Frequency')

plt.tight_layout()
plt.show()
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/11.png?raw=true" width="900" height="250"></p>

ğŸ‘€ **êµ°ì§‘ ì‹œê°í™”**

````python
sns.pairplot(data[['label_kmeans', 'Income', 'Year_Birth', 'MntMeatProducts']],
            diag_kind='kde',
            hue="label_kmeans", 
            corner =True, 
            palette='bright')
plt.show()
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/12.png?raw=true" width="900" height="600"></p>

ğŸ‘€ **êµ°ì§‘ ì‹œê°í™”-PCA**

````python
from sklearn.decomposition import PCA

X = df_encoded.drop(columns=['ID']).reset_index(drop=True)

# PCA ëª¨ë¸ ìƒì„± ë° ì í•©
pca = PCA(n_components=2)  # ì£¼ì„±ë¶„ 2ê°œ ì„ íƒ
pca.fit(X)

# ì£¼ì„±ë¶„ê³¼ ì£¼ì„±ë¶„ì˜ ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ í™•ì¸
print("ì£¼ì„±ë¶„ (Principal Components):")
print(pca.components_)
print("\nì£¼ì„±ë¶„ì˜ ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ (Explained Variance Ratio):")
print(pca.explained_variance_ratio_)

# ë°ì´í„°ë¥¼ ì£¼ì„±ë¶„ìœ¼ë¡œ ë³€í™˜
X_pca = pca.transform(X)

# ì£¼ì„±ë¶„ìœ¼ë¡œ ë³€í™˜ëœ ë°ì´í„° ì‹œê°í™”
plt.scatter(X_pca[:, 0], X_pca[:, 1], c=data['label_kmeans'])
plt.xlabel('PC 1 (Principal Component 1)')
plt.ylabel('PC 2 (Principal Component 2)')
plt.title('PCA Plot')
plt.show()
````

````
ì£¼ì„±ë¶„ì˜ ì„¤ëª…ëœ ë¶„ì‚° ë¹„ìœ¨ (Explained Variance Ratio):
[9.99799806e-01 1.33989352e-04]
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/13.png?raw=true" width="600" height="500"></p>

ğŸ“ **êµ°ì§‘í™” ê²°ê³¼**

- dbscanì€ êµ°ì§‘í™”ê°€ ê³¨ê³ ë£¨ ë˜ì§€ ì•ŠìŒì„ í™•ì¸
- Kmeansë¥¼ í†µí•œ êµ°ì§‘í™”ëŠ” ë¶„í¬ê°€ ê· ì¼
- PCAë¥¼ í†µí•´ í™•ì¸í•´ ë³´ì•„ë„ êµ¬ë¶„ì´ ì˜ ë˜ì–´ìˆìŒì„ í™•ì¸

## 2. êµ°ì§‘ë¶„ì„

### 2.1 êµ°ì§‘ì˜ íŠ¹ì„± ë¶„ì„

ğŸ‘€ **ê·¸ë£¹ë³„ ë°ì´í„° í™•ì¸**

````python
data_group = df_encoded.drop(columns=['ID']).groupby('label').mean()
data_group
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/14.png?raw=true" width="900" height="100"></p>

````python
fig, axes = plt.subplots(4, 6, figsize=(16, 12))

columns = data_group.columns.to_list()

for i, column in enumerate(columns):
    row = i // 6
    col = i % 6
    sns.barplot(x=data_group.index, y=column, data=data_group, ax=axes[row, col])
    axes[row, col].set_title(f'Average {column}')
    axes[row, col].set_xlabel("data_group")
    axes[row, col].set_ylabel(f'Average {column}')

plt.tight_layout()
plt.show()
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/15.png?raw=true" width="900" height="700"></p>

ğŸ“ **ê·¸ë£¹ë³„ ë°ì´í„° íŠ¹ì„±**
1. ê³ ê° ì •ë³´ ë°ì´í„°
- Income: ê·¸ë£¹ 0 > 2> 1 ìˆœìœ¼ë¡œ ì†Œë“ì˜ ì°¨ì´ê°€ ìˆìŒ
- Kidhome, Teenhome: ê·¸ë£¹ 1ì—ëŠ” ì•„ì´ê°€ 2ê·¸ë£¹ì—ëŠ” ì²­ì†Œë…„ì´ ìˆëŠ” ê³ ê°ì´ ë§ì´ ë¶„í¬ë¨
- Marital_Status: ê·¸ë£¹ 0ì—ë§Œ Absurdê°€ ìˆìœ¼ë©° Aloneì—ëŠ” ê·¸ë£¹ 0ì´ ì—†ìŒ, ê·¸ë£¹ 2ì—ë§Œ YOLOê°€ ì¡´ì¬
2. ì†Œë¹„ ì œí’ˆ ë°ì´í„°
- ê·¸ë£¹ 0ì€ ëŒ€ë¶€ë¶„ì˜ ì†Œë¹„ ì œí’ˆì—ì„œ ë†’ì€ ë¹„ìœ¨ì„ ì°¨ì§€
3. êµ¬ë§¤ ì±„ë„ ë°ì´í„°
- ê·¸ë£¹ 0ì€ ë‹¤ì–‘í•œ êµ¬ë§¤ì±„ë„ì„ í™œìš©í•˜ë‚˜ ì›¹í˜ì´ì§€ ë°©ë¬¸ íšŸìˆ˜ëŠ” ì ìŒ
- ê·¸ë£¹ 1, 2ëŠ” ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ëŠ” ë¹„ì¤‘ì€ ë†’ìœ¼ë‚˜ ì§ì ‘ êµ¬ë§¤ë¡œ ì´ë£¨ì–´ì§€ì§€ëŠ” ì•ŠìŒ

ğŸ“ **ê·¸ë£¹ë³„ ë°ì´í„° í•´ì„**
- ê·¸ë£¹ 0ì€ ë†’ì€ ì†Œë“ì„ ê¸°ë°˜ìœ¼ë¡œ ë§ì€ ì†Œë¹„ë¥¼ í•¨
- ê·¸ë£¹ 1ì€ ìƒëŒ€ì ìœ¼ë¡œ ì Šì€ ê³ ê°ì´ ì£¼ë¥¼ ì´ë£¨ë©° ì›¹ ì‚¬ì´íŠ¸ ë°©ë¬¸ì„ ë§ì´í•˜ë‚˜ ì†Œë“ì´ ë‚®ì•„ êµ¬ë§¤ ë¹„ìœ¨ì´ ë‚®ìŒ
- ê·¸ë£¹ 2ëŠ” ê·¸ë£¹ 1ê³¼ 2ì˜ ì¤‘ê°„ ì •ë„ì˜ íŠ¹ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ê³ ê°ìœ¼ë¡œ ë³´ì„

### 2.2 êµ°ì§‘ë³„ ìƒí’ˆ ì¶”ì²œ

ğŸ‘€ **ê·¸ë£¹ë³„ êµ¬ë§¤ ë¹„ìœ¨**

````python
# ê° ì—´ì˜ ë¹„ìœ¨ ê³„ì‚°
df_mnt = data_group[["MntWines","MntFruits","MntMeatProducts","MntFishProducts","MntSweetProducts"]]
df_ratios = df_mnt.divide(df_mnt.sum(axis=1), axis=0)
df_ratios
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/16.png?raw=true" width="900" height="150"></p>

ğŸ“ **ê·¸ë£¹ë³„ ë°ì´í„° í•´ì„**

- ê·¸ë£¹ 0: ì™€ì¸ ì¶”ì²œ
- ê·¸ë£¹ 1: ê³ ê¸° ì¶”ì²œ
- ê·¸ë£¹ 2: ì™€ì¸ ì¶”ì²œ

### 2.3 íŠ¹ì • ê³ ê° ëŒ€ìƒ ìƒí’ˆ ì¶”ì²œ (ID=10870)

````python
data[data.ID == 10870]
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/17.png?raw=true" width="900" height="50"></p>

````python
data_group.iloc[2,:]
````

````
Year_Birth              1966.114957
Income                 52364.688504
Kidhome                    0.412855
Teenhome                   0.815822
MntWines                 290.609394
MntFruits                 19.034611
MntMeatProducts          101.075402
MntFishProducts           25.189122
MntSweetProducts          18.262052
NumDealsPurchases          3.100124
NumWebPurchases            4.744129
NumCatalogPurchases        2.254635
NumStorePurchases          6.065513
NumWebVisitsMonth          5.692213
Category_Absurd            0.000000
Category_Alone             0.001236
Category_Divorced          0.117429
Category_Married           0.372064
Category_Single            0.203956
Category_Together          0.259580
Category_Widow             0.043263
Category_YOLO              0.002472
````

ğŸ“ **ë°ì´í„°ì— ê¸°ë°˜í•œ ìƒí’ˆ ì¶”ì²œ**

- í•´ë‹¹ ê³ ê°ì€ ê·¸ë£¹ 2ì— ì†í•˜ë¯€ë¡œ ì™€ì¸ì„ ì¶”ì²œ
- ì›¹ì—ì„œ êµ¬ë§¤í•˜ëŠ” ë¹„ì¤‘ì´ ê·¸ë£¹ 2ì˜ í‰ê· ë³´ë‹¤ ë†’ìœ¼ë¯€ë¡œ ì›¹ í™ë³´ ì „ëµ ìˆ˜í–‰

# í†µê³„ë¶„ì„

## 1. ê°€ì„¤ ê²€ì • (1)

### í•œ ê³µì¥ì—ì„œ ìƒì‚°ëœ ì œí’ˆì—ì„œ ìµœê·¼ ì¶”ì • ë¶ˆëŸ‰ë¥ ì€ 90%ì˜€ë‹¤. ì˜¤ì°¨ì˜ í•œê³„ê°€ 5% ì´í•˜ê°€ ë˜ë„ë¡ í•˜ëŠ” ìµœì†Œ í‘œë³¸ ì‚¬ì´ì¦ˆë¥¼ êµ¬í•˜ì‹œì˜¤

âœï¸ **ë¬¸ì œ ì •ì˜**
- ë‹¨ì¼ ì§‘ë‹¨ì˜ ëª¨ë¹„ìœ¨ ì‹ ë¢°êµ¬ê°„ í‘œë³¸ í¬ê¸°ë¥¼ êµ¬í•˜ëŠ” ë¬¸ì œ
- ì¶”ì • ë¶ˆëŸ‰ë¥  90%, ì˜¤ì°¨í•œê³„ 5%
- ê°€ì •: ì‹ ë¢°êµ¬ê°„ 95%

````python
p = 0.9
e = 0.05
confidence = 0.95

from scipy.stats import norm

# ì •ê·œ ë¶„í¬ì˜ í‰ê· ê³¼ í‘œì¤€ í¸ì°¨
mu = 0
sigma = 1

two_side_alpha = (1 - confidence)/2
two_side = 1 - two_side_alpha

one_side_alpha = 1 - confidence
one_side = 1 - one_side_alpha

two_side_value = norm.ppf(two_side, loc=mu, scale=sigma)
one_side_value = norm.ppf(one_side, loc=mu, scale=sigma)

print(f"Z ë¶„í¬ 95% ì–‘ì¸¡ê²€ì • ë°±ë¶„ìœ„ìˆ˜: {two_side_value}")
````

````
Z ë¶„í¬ 95% ì–‘ì¸¡ê²€ì • ë°±ë¶„ìœ„ìˆ˜: 1.959963984540054
````

````python
n = two_side_value**2 * (p*(1-p)) / e**2
print("ìµœì†Œ í‘œë³¸ ìˆ˜ :", int(np.ceil(n)))
````

````
ìµœì†Œ í‘œë³¸ ìˆ˜ : 139
````

## 2. ê°€ì„¤ ê²€ì • (2)

### ì•„ë˜ ê·¸ë˜í”„ëŠ” A, B, C ìì¹˜êµ¬ë³„ H ì˜ì›ì— ëŒ€í•œ ì°¬ì„±, ë°˜ëŒ€ íˆ¬í‘œ ê²°ê³¼ì´ë‹¤. ìì¹˜êµ¬ë³„ ì§€ì§€ìœ¨ì´ ê°™ì€ì§€ì— ëŒ€í•´ì„œ ê²€ì •í•˜ì‹œì˜¤.

````python
df = pd.DataFrame({'A':[176, 124], 'B':[193, 107], 'C':[159, 141],'gubun':['agree','disagree']})
df = df.set_index('gubun').T
df
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/18.png?raw=true" width="300" height="150"></p>

âœï¸ **ë¬¸ì œ ì •ì˜**
- ë²”ì£¼í˜• ë³€ìˆ˜ì— ëŒ€í•œ ë¹ˆë„ìˆ˜ë¥¼ ì‚¬ìš©í•œ ë¶„ì„ â˜ êµì°¨ë¶„ì„
- ì§€ì§€ìœ¨ì€ ë¹„ìœ¨ì´ê¸°ì— ì í•©ì„± ê²€ì •

ğŸ“ **ê°€ì„¤ ìˆ˜ë¦½**
- H0: ì§€ì§€ìœ¨ì´ ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ì—†ìŒ
- H1: ì§€ì§€ìœ¨ì´ ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ìˆìŒ

````python
df['support'] = df.agree / (df.agree + df.disagree)
df['support']
````

````
A    0.586667
B    0.643333
C    0.530000
````

````python
from scipy.stats import chisquare
ratio = df.support.sum()/3
chi = chisquare(df['support'], f_exp=[ratio, ratio, ratio])
chi
````

````
Power_divergenceResult(statistic=0.010946969696969688, pvalue=0.9945414673770099)
````

ğŸ“ **ì í•©ë„ ê²€ì • í•´ì„**

- p-valueê°€ 0.05ë³´ë‹¤ í¬ë¯€ë¡œ ê·€ë¬´ê°€ì„¤ ì±„íƒ
- ìì¹˜êµ¬ë³„ ì§€ì§€ìœ¨ì´ ë‹¤ë¥´ë‹¤ê³  í•  ìˆ˜ ì—†ìŒ

## 3. ê°€ì„¤ ê²€ì •(3)

### Aí•™êµ ë‚¨ë…€ í•™ìƒë“¤ì˜ í‰ê·  í˜ˆì•• ì°¨ì´ê°€ ìˆëŠ”ì§€ ì—¬ë¶€ì— ëŒ€í•œ ê²€ì •í•˜ì‹œì˜¤

- (ë‹¨, ë‚¨í•™ìƒê³¼ ì—¬í•™ìƒì˜ í˜ˆì•• ë°ì´í„°ëŠ” ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ë©° ë“±ë¶„ì‚°ì„ì„ ê°€ì •)

````python
import pandas as pd
data = pd.read_csv("https://raw.githubusercontent.com/ADPclass/ADP_book_ver01/main/data/26_problem6.csv")
data
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/19.png?raw=true" width="200" height="600"></p>

âœï¸ **ë¬¸ì œ ì •ì˜**
- í‰ê·  í˜ˆì•• ì°¨ì´ â˜ ë‘ê°œ ì§‘ë‹¨ ì°¨ì´ ê°€ì„¤ê²€ì •
- ì •ê·œì„±ê³¼ ë“±ë¶„ì‚°ì„±ì„ ê°€ì •í•˜ê³  ìˆìŒ â˜ ë¶„ì‚°ì´ ê°™ì€ ë…ë¦½í‘œë³¸ t-test

### 3.1 ë‚¨ë…€ í•™ìƒë“¤ì˜ í‰ê·  í˜ˆì•• ì°¨ì´ê°€ ìˆëŠ”ì§€ ê°€ì„¤ ìˆ˜ë¦½
ğŸ“ **ê°€ì„¤ ìˆ˜ë¦½**
- H0: ë‚¨ë…€ í•™ìƒ í‰ê·  í˜ˆì•• ì°¨ì´ëŠ” ì—†ìŒ
- H1: ë‚¨ë…€ í•™ìƒ í‰ê·  í˜ˆì•• ì°¨ì´ëŠ” ìˆìŒ

### 3.2 ê²€ì •í†µê³„ëŸ‰ì„ êµ¬í•˜ê³  íŒë‹¨

````python
from scipy import stats

# ë…ë¦½í‘œë³¸ ë°ì´í„° ì„¤ì •
group1 = np.array(data[data.gender=='male'].pressure)
group2 = np.array(data[data.gender=='female'].pressure)

# ë…ë¦½í‘œë³¸ t-ê²€ì • ìˆ˜í–‰
result = stats.ttest_ind(a=group1, b=group2, equal_var=False)

# ê²°ê³¼ ì¶œë ¥
print(result)
````

````
Ttest_indResult(statistic=1.3495215111176884, pvalue=0.19643211975943328)
````

ğŸ“ **t-test í•´ì„**
- p-valueê°€ 0.05ë³´ë‹¤ í¬ê¸°ì—ì— ê·€ë¬´ê°€ì„¤ ì±„íƒ
- ë‚¨ë…€ í•™ìƒ í‰ê·  í˜ˆì•• ì°¨ì´ëŠ” ì—†ìŒ

### 3.3 í‰ê·  í˜ˆì••ì°¨ì˜ ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ê³  ê²°ê³¼ê°€ 3.2ì˜ ê²°ê³¼ë¥¼ ì§€ì§€í•˜ëŠ”ì§€ ì„¤ëª…

âœï¸ **ë¬¸ì œ ì •ì˜**
- ëª¨í‰ê·  ì°¨ì´ ì‹ ë¢°êµ¬ê°„ - ëª¨ë¶„ì‚°ì„ ëª¨ë¥´ëŠ” ê²½ìš°
- ì†Œí‘œë³¸ì— ëŒ€í•œ ì‹ ë¢°êµ¬ê°„
- ì‹ ë¢°êµ¬ê°„ì€ 95% ì„¤ì •

````python
mu_male = data[data.gender == 'male'].pressure.mean()
mu_female = data[data.gender == 'female'].pressure.mean()
n_male = len(data[data.gender == 'male'])
n_female = len(data[data.gender == 'female'])
dof = n_male + n_female -2
std_male = data[data.gender == 'male'].pressure.std()
std_female = data[data.gender == 'female'].pressure.std()

# ê²°í•© ë¶„ì‚° êµ¬í•˜ê¸°
def get_sp(n1, n2, s1, s2):
    under = n1+n2-2
    over1 = (n1-1) * s1**2
    over2 = (n2-1) * s2**2
    return np.sqrt((over1 + over2)/under)
  
sp = get_sp(n_male, n_female, std_male, std_female)

# ë¶„í¬ ê°’ êµ¬í•˜ê¸°
from scipy.stats import t

confidence = 0.95

two_side_alpha = (1 - confidence)/2
two_side = 1 - two_side_alpha

two_side_value = t.ppf(two_side, df=dof)

print(f"t ë¶„í¬ 95% ì–‘ì¸¡ê²€ì • ë°±ë¶„ìœ„ìˆ˜: {two_side_value}")
````

````
t ë¶„í¬ 95% ì–‘ì¸¡ê²€ì • ë°±ë¶„ìœ„ìˆ˜: 2.0686576104190406
````

````python
mu_diff = mu_male - mu_female
sqrt = np.sqrt((1/n_male) +  (1/n_female))
under = mu_diff - two_side_value * sp * sqrt
over = mu_diff + two_side_value * sp * sqrt

print("í‘œë³¸ í‰ê·  ì°¨ì´: ", mu_diff)
print("ì‹ ë¢°êµ¬ê°„: ", under, over)
````

````
í‘œë³¸ í‰ê·  ì°¨ì´: 5.296527777777783
ì‹ ë¢°êµ¬ê°„: -2.635362714413926 13.228418269969492
````

ğŸ“ **ì‹ ë¢°êµ¬ê°„ í•´ì„**
- ë³´ìœ í•œ ë°ì´í„°ì˜ í‰ê· ì˜ ì°¨ì´ê°€ ì‹ ë¢°êµ¬ê°„ ì•ˆì— ë“¤ì–´ê°
- 3.2ì˜ í˜ˆì•• ì°¨ì´ê°€ ì—†ìŒì— ë¶€í•©

## 4. ì‹œê³„ì—´ ë¶„ì„

### ë‹¤ìŒì€ 1ì›”ë¶€í„° 9ì›”ê¹Œì§€ì˜ ì€ì˜ ê°€ê²©ì´ë‹¤.

````python
import pandas as pd
import numpy as np
data = pd.read_csv("https://raw.githubusercontent.com/ADPclass/ADP_book_ver01/main/data/26_problem4.csv")
data
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/20.png?raw=true" width="500" height="50"></p>

### 4.1 ì€ì˜ ê°€ê²© ë° ì´ë™í‰ê· ê°’ 3ì´ ì„¤ì •ëœ ì‹œê³„ì—´ ê·¸ë˜í”„

````python
ma_data = data.transpose( )
ma_data.columns = ["month_price"]
ma_data['ma_3'] = ma_data['month_price'].rolling(window=3).mean()
ma_data.fillna(0, inplace=True)
ma_data
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/21.png?raw=true" width="200" height="300"></p>

````python
plt.plot(ma_data.index, ma_data['month_price'][:],c='blue',marker='o')
plt.plot(ma_data.index[2:], ma_data['ma_3'][2:],c='red')
````

<p align="center"><img src="https://github.com/sigirace/page-images/blob/main/adp/problem/practice4/22.png?raw=true" width="900" height="350"></p>

### 4.2 1ì›” ëŒ€ë¹„ 9ì›”ì˜ ì€ì˜ ê°€ê²©ì€ ëª‡ % ì˜¬ëëŠ”ê°€?(ì†Œìˆ˜ì  ë‘ë²ˆì§¸ ìë¦¬ì—ì„œ ë°˜ì˜¬ë¦¼)

- ëŒ€ë¹„ ì¦ê°ë¥ : (ë¹„êµ-ê¸°ì¤€)/ê¸°ì¤€ * 100
- A ëŒ€ë¹„ B â˜ Aê°€ ê¸°ì¤€

````python
m9 = ma_data["month_price"][-1]
m1 = ma_data["month_price"][0]
print("ì¦ê°ë¥  {}%".format(round((m9-m1)/m1*100,1)))
````

````
ì¦ê°ë¥  158.5%
````





